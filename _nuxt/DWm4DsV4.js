import{_ as U}from"./Bo0nr4fi.js";import{V as N,f as D,_ as R}from"./DJqyd759.js";import{V as A,u as B,a as L}from"./D-Y_yOlY.js";import{_ as j,r as n,n as z,c as $,u as a,s as I,w as l,v as b,a as i,d as m,t as p,b as r,x as M,q as w,o as v,p as O,e as q}from"./DXYCrU_g.js";import{a as G,V as H,c as x}from"./BWT_Zoyk.js";import"./BX-cLuhO.js";import"./C66lCPcI.js";var y={};const J=u=>(O("data-v-698e8de2"),u=u(),q(),u),K={key:1},Q={class:"d-flex justify-space-between mb-4 ga-4"},W={class:"w-50"},X={class:"bg-accent pa-4"},Y={class:"bg-accent mr-12"},Z={class:""},ee=J(()=>i("h1",{class:"mt-12 pb-4 d-flex"},"User Files",-1)),te=["onClick"],ae={__name:"MyFiles",setup(u){const c=n(null),h=n(!1),g=n(""),_=n(""),V=n(""),o=n([]),E=[{title:"Name",value:"originalname",sortable:!0},{title:"Page count",value:"numberOfPages",sortable:!0},{title:"Size (kb)",value:"size",sortable:!0},{title:"Format",value:"format"},{title:"Upload Date",value:"uploadDate",sortable:!0},{title:"Visibility",value:"visibility",sortable:!0},{title:"Delete",value:"delete",sortable:!1}];async function F(){const t=B("userId");if(!t.value){w("/");return}try{const e=await $fetch(`${y.API_URL}/users/${t.value}`,{method:"GET",credentials:"include"});c.value=e,V.value=e.user._id,o.value=D(e.files)}catch(e){w("/"),console.error("Error fetching user data:",e)}}async function P(t){const e=o.value.findIndex(d=>d._id===t),f=o.value[e].visibility;try{await $fetch(`${y.API_URL}/api/files/${t}`,{method:"PATCH",body:{visibility:!f},credentials:"include"}),o.value[e].visibility=!f}catch(d){console.error("Error fetching user data:",d)}}async function T(t){try{await $fetch(`${y.API_URL}/api/files/${t}`,{method:"DELETE",credentials:"include"}),o.value=o.value.filter(e=>e._id!==t)}catch(e){console.error("Error fetching user data:",e)}}function k(t){t&&(g.value=t),h.value=!h.value}function S(t){const e=D([t])[0];o.value.push(e)}return z(()=>{F()}),(t,e)=>{const f=U,d=R;return v(),$("div",null,[a(c)?b("",!0):(v(),I(G,{key:0,fluid:""},{default:l(()=>[r(L,{class:"h-screen align-center justify-center"},{default:l(()=>[r(H,{size:70,width:7,color:"primary",indeterminate:""})]),_:1})]),_:1})),a(c)?(v(),$("div",K,[i("div",Q,[i("div",W,[i("div",X,[i("p",Y,[m(" Name: "),i("b",null,p(a(c).user.name),1)]),i("p",Z,[m(" Email: "),i("b",null,p(a(c).user.email),1)])]),ee]),r(f,{userId:a(V),onSuccess:S},null,8,["userId"])]),r(A,{modelValue:a(_),"onUpdate:modelValue":e[0]||(e[0]=s=>M(_)?_.value=s:null),label:"Search","solo-inverted":"","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"]),r(N,{headers:E,items:a(o),"item-key":"_id",class:"elevation-1",search:a(_)},{"item.originalname":l(({item:s})=>[i("span",{class:"clickable",onClick:C=>k(s.path)},p(s.originalname),9,te)]),"item.visibility":l(({item:s})=>[r(x,{onClick:C=>P(s._id)},{default:l(()=>[m(p(s.visibility?"mdi-eye":"mdi-eye-off"),1)]),_:2},1032,["onClick"])]),"item.delete":l(({item:s})=>[r(x,{onClick:C=>T(s._id)},{default:l(()=>[m("mdi-delete")]),_:2},1032,["onClick"])]),_:1},8,["items","search"]),a(h)?(v(),I(d,{key:0,onClose:k,path:a(g)},null,8,["path"])):b("",!0)])):b("",!0)])}}},de=j(ae,[["__scopeId","data-v-698e8de2"]]);export{de as default};
