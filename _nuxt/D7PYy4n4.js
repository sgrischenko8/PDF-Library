import{_ as oe}from"./BNnLPbCh.js";import{b as F,c as q,d as z,e as G,u as re,a as O,f as ue,V as L}from"./CxJnXZT_.js";import{y as E,z as K,A as ne,B as ie,C as de,D as ce,E as fe,r as p,o as d,s as y,w as s,b as i,F as me,d as _,u as e,x as w,_ as ge,n as ve,c as A,a as D,v as f,G as pe,t as $}from"./z_9WcUHJ.js";import{m as ye,b,a as _e,c as M,V as Ve}from"./BZs8Hu5N.js";import"./DP6WPsug.js";const H=E.reduce((a,l)=>(a[l]={type:[Boolean,String,Number],default:!1},a),{}),W=E.reduce((a,l)=>{const o="offset"+K(l);return a[o]={type:[String,Number],default:null},a},{}),Y=E.reduce((a,l)=>{const o="order"+K(l);return a[o]={type:[String,Number],default:null},a},{}),j={col:Object.keys(H),offset:Object.keys(W),order:Object.keys(Y)};function ke(a,l,o){let u=a;if(!(o==null||o===!1)){if(l){const n=l.replace(a,"");u+=`-${n}`}return a==="col"&&(u="v-"+u),a==="col"&&(o===""||o===!0)||(u+=`-${o}`),u.toLowerCase()}}const Ce=["auto","start","end","center","baseline","stretch"],he=ne({cols:{type:[Boolean,String,Number],default:!1},...H,offset:{type:[String,Number],default:null},...W,order:{type:[String,Number],default:null},...Y,alignSelf:{type:String,default:null,validator:a=>Ce.includes(a)},...ie(),...ye()},"VCol"),be=de()({name:"VCol",props:he(),setup(a,l){let{slots:o}=l;const u=ce(()=>{const n=[];let V;for(V in j)j[V].forEach(c=>{const h=a[c],m=ke(V,c,h);m&&n.push(m)});const C=n.some(c=>c.startsWith("v-col-"));return n.push({"v-col":!C||!a.cols,[`v-col-${a.cols}`]:a.cols,[`offset-${a.offset}`]:a.offset,[`order-${a.order}`]:a.order,[`align-self-${a.alignSelf}`]:a.alignSelf}),n});return()=>{var n;return fe(a.tag,{class:[u.value,a.class],style:a.style},(n=o.default)==null?void 0:n.call(o))}}}),$e={__name:"SuccessModal",setup(a){const l=p(!0);return(o,u)=>(d(),y(G,{modelValue:e(l),"onUpdate:modelValue":u[1]||(u[1]=n=>w(l)?l.value=n:null),"max-width":"500"},{default:s(()=>[i(F,null,{default:s(()=>[i(q,null,{default:s(()=>[me(o.$slots,"text",{},()=>[_("Completed")])]),_:3}),i(z,null,{default:s(()=>[i(b,{color:"primary",onClick:u[0]||(u[0]=n=>l.value=!1)},{default:s(()=>[_("Close")]),_:1})]),_:1})]),_:3})]),_:3},8,["modelValue"]))}};var k={};const we={key:0,class:"text-right pr-4"},Pe={key:0,class:"errorMessage text-left mr-auto pl-4"},Ue={__name:"index",setup(a){const l=re("userId"),o=p(null),u=p(!1),n=p(null),V=p(""),C=p(""),c=p(""),h=p(""),m=p(""),P=p(""),g=p(null),U=p(!1),S=p(!1);function J(){o.value==="sign"&&X(),o.value==="login"&&Z(),o.value==="changeUserData"&&ae()}const Q={sign:"Create account",login:"Login",changeUserData:"Change account data"};function x(){m.value="",o.value=null,u.value=!1}function I(t){o.value=t}async function X(){try{await $fetch(`${k.API_URL}/users/register`,{method:"POST",body:{name:V.value,email:C.value,password:c.value},credentials:"include"}),n.value="sign",x()}catch(t){console.log("Error adding user:",t.response._data.message),m.value=t.response._data.message}}async function Z(){try{const t=await $fetch(`${k.API_URL}/users/login`,{method:"POST",body:{email:C.value,password:c.value},credentials:"include"});t.photo&&(P.value=`${k.API_URL}/${t.photo}`),x(),g.value=t,l.value=t._id}catch(t){console.error("Error logging user:",t),m.value=t.response._data.message}}async function ee(){try{await $fetch(`${k.API_URL}/users/logout`,{method:"POST",credentials:"include"}),n.value="logout",m.value="",g.value={},l.value=""}catch(t){console.error("Error logging user:",t),l.value="",m.value=t.response._data.message}}async function R(){try{if(!l.value){g.value={};return}const t=await $fetch(`${k.API_URL}/users/current`,{method:"GET",credentials:"include"});g.value=t,t.photo&&(P.value=`${k.API_URL}/${t.photo}`)}catch(t){console.error("Error fetching user data:",t),g.value=[],l.value=null}}async function ae(){if(c.value!==h.value){m.value="Passwords do not match";return}const t={};if(V.value&&(t.name=V.value),c.value&&(t.password=c.value),Object.keys(t).length===0){m.value="No data to update";return}l.value=g.value._id;try{const r=await $fetch(`${k.API_URL}/users/${g.value._id}`,{method:"PATCH",body:t,credentials:"include"});x(),g.value=r,V.value="",c.value="",h.value=""}catch(r){console.error("Error updating user data:",r),m.value=r.response._data.message}}function te(t){P.value=`${k.API_URL}/${t}`,R()}function le(){U.value=!U.value}return ve(()=>{R()}),(t,r)=>{const se=oe,N=$e;return d(),A(pe,null,[D("div",null,[i(O,{class:"d-block"},{default:s(()=>{var v;return[i(be,{class:"text-right ml-auto"},{default:s(()=>{var T;return[e(l)?f("",!0):(d(),y(b,{key:0,color:"primary",class:"mr-4",onClick:r[0]||(r[0]=B=>(I("sign"),u.value=!0))},{default:s(()=>[_("Sign in")]),_:1})),e(l)?f("",!0):(d(),y(b,{key:1,color:"primary",onClick:r[1]||(r[1]=B=>(I("login"),u.value=!0))},{default:s(()=>[_("Log in")]),_:1})),e(l)?(d(),y(b,{key:2,class:"mr-4 mb-4",color:"primary",onClick:ee},{default:s(()=>[_("Log out")]),_:1})):f("",!0),e(l)?(d(),y(b,{key:3,color:"primary",class:"mb-4",onClick:r[2]||(r[2]=B=>(I("changeUserData"),u.value=!0))},{default:s(()=>[_("Change data")]),_:1})):f("",!0),(T=e(g))!=null&&T.name?(d(),y(se,{key:4,userId:e(l),onSuccess:te,imgPath:e(P)},null,8,["userId","imgPath"])):f("",!0)]}),_:1}),e(l)&&((v=e(g))!=null&&v.name)?(d(),A("div",we,[D("p",null,$(e(g).name),1),D("p",null,$(e(g).email),1)])):f("",!0)]}),_:1}),i(G,{modelValue:e(u),"onUpdate:modelValue":r[8]||(r[8]=v=>w(u)?u.value=v:null),"max-width":"500"},{default:s(()=>[i(F,null,{default:s(()=>[i(q,null,{default:s(()=>[D("span",null,$(Q[e(o)]),1)]),_:1}),i(ue,null,{default:s(()=>[e(o)!=="login"?(d(),y(L,{key:0,modelValue:e(V),"onUpdate:modelValue":r[3]||(r[3]=v=>w(V)?V.value=v:null),label:"Name","aria-required":"true"},null,8,["modelValue"])):f("",!0),e(o)!=="changeUserData"?(d(),y(L,{key:1,modelValue:e(C),"onUpdate:modelValue":r[4]||(r[4]=v=>w(C)?C.value=v:null),label:"Email","aria-required":"true"},null,8,["modelValue"])):f("",!0),i(L,{modelValue:e(c),"onUpdate:modelValue":r[5]||(r[5]=v=>w(c)?c.value=v:null),label:"password",type:e(U)?"text":"password","aria-required":"true"},{default:s(()=>[i(M,{onClick:le,class:"position-absolute right-0 pr-4"},{default:s(()=>[_($(e(U)?"mdi-eye":"mdi-eye-off"),1)]),_:1})]),_:1},8,["modelValue","type"]),e(o)==="changeUserData"?(d(),y(L,{key:2,modelValue:e(h),"onUpdate:modelValue":r[7]||(r[7]=v=>w(h)?h.value=v:null),label:"Repeat new password",type:e(S)?"text":"password","aria-required":"true"},{default:s(()=>[i(M,{onClick:r[6]||(r[6]=v=>S.value=!e(S)),class:"position-absolute right-0 pr-4"},{default:s(()=>[_($(e(S)?"mdi-eye":"mdi-eye-off"),1)]),_:1})]),_:1},8,["modelValue","type"])):f("",!0)]),_:1}),i(z,null,{default:s(()=>[e(m)?(d(),A("p",Pe,$(e(m)),1)):f("",!0),i(b,{color:"primary",onClick:x},{default:s(()=>[_("Close")]),_:1}),i(b,{color:"primary",onClick:J},{default:s(()=>[_("Confirm")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(n)==="sign"?(d(),y(N,{key:0},{text:s(()=>[_("Registration completed successfully!")]),_:1})):f("",!0),e(n)==="changeUserData"?(d(),y(N,{key:1},{text:s(()=>[_("User data updated successfully")]),_:1})):f("",!0),e(n)==="logout"?(d(),y(N,{key:2},{text:s(()=>[_("You have Log out successfully")]),_:1})):f("",!0)]),e(g)?f("",!0):(d(),y(_e,{key:0,fluid:""},{default:s(()=>[i(O,{class:"h-screen align-center justify-center"},{default:s(()=>[i(Ve,{size:70,width:7,color:"primary",indeterminate:""})]),_:1})]),_:1}))],64)}}},Ne=ge(Ue,[["__scopeId","data-v-8863776a"]]);export{Ne as default};
